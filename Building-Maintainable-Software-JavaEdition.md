# 《*Building Maintainable Software, Java Edition 打造可維護軟體：編寫可維護程式碼的10項法則 (Java版)*》

在圖書館看到這本書，也才一百多頁而已，看到出版商歐萊禮就翻了一下覺得不錯，就借回家來讀，第一次嘗試寫學習筆記，也是嘗試使用更好的學習方法，希望自己未來更強。

> **作者：葉高緯 Wei the Shinobi**

# 1. 簡短的程式碼

> 傻瓜也可寫出電腦能懂得程式碼，但優秀的工程師才能寫出人類能夠理解的程式碼 。	— Martin Fowler
>

**程式碼單元的長度應在15行內。**

## 1.1 好處

- 容易測試
- 容易分析
- 容易複用

## 1.2 重構技巧

1. 提取方法：將一段很長的程式碼，提取出一部份拆分成新的方法。不僅好讀，還可實現程式碼複用。

- 那如果遇到需要傳送很多區域變數的情況呢？拆分出來的新方法要傳一長串參數肯定很麻煩，這時我們需要另尋他法。

2. 以物件方法取代方法：如果你要傳送一長串的變數，可以把某些要傳遞的區域變數，轉變成類別的私有欄位。就是提升作用域的意思。

```java
class Something {
   void doSomething(int x,String y,int a,int b, int c, int d){
        // ...
    }
}
```

改寫成

```java
class Something {
    private int x;
    private String y;
    
    Something(int x,String y) {
        this.x = x;
        this.y = y;
    }
    
    void doSomething(int a,int b, int c, int d){
        // ...
    }
}
```

## 1.3 討論

1. 效能
   - 實際上效能不會有太大的差別，而且兩害取其輕。
2. 拆分程式碼難以閱讀
   - 其實不會。

#  2. 簡單的程式碼

> 每個問題都是由一些小問題組成的。	— Martin Fowler
>

- **每個程式碼單元不超過4個邏輯分支點。**
- **拆分，避免複雜的糾結。**
- **分支越少，測試及修改能越簡單。**

越多的分支，就有越高的**循環複雜度**，你需要測試的路徑分支就越多。

## 2.1 switch case

- 一長串的switch看起來無害，可讀性也很強，但是想要測試方法需要寫很多個的測試案例。

  1. 替換成map，從map取值時再做出判斷。
  2. 替換成多型。

## 2.2 處理嵌套語句

- 以衛述句取代嵌套條件式
  - 識別不同狀況插入return，來替代嵌套的條件語句。
  - 還可以再使用**提取方法**的技巧來拆分方法。

## 2.3 討論

1. 高複雜度無可避免？

   - 複雜的知識領域未必需要複雜的實作，你還是可以建構簡單的技術方案，而這完全可以辦到。

2. 拆分方法不會降低複雜度

   > 將1個循環複雜度為15的方法拆成3個循環複雜度為5的方法不會降低整體的複雜度，這根本沒用。

   - 的確，但會更容易測試和理解，新撰寫的單元測試也能更簡單。

# 3. 不重複的程式碼

> 排名第一的程式碼壞味道就是程式碼重複。	— Kent Beck 與 Martin Fowler，《*Bad Smells in Code*》

- **禁止程式碼重複。**

## 3.1 定義

- 長度至少6行的一段相同程式碼，不包括空白和註解。

> 複製就像技術債，將來要修改會很痛苦。

# 4. 參數簡單的程式碼

> 四處分散的相關資料應該被封裝成一個物件。	— Martin Fowler

- 限制程式碼單元的參數**不超過4個**。
- **將多個參數提取到class**來達成。
- 較少的參數較容易理解與重複使用。







# 待更新...

