# Clean Architecture

## 架構

### 結構式

減去了 goto

限制了程式的控制

### 物件導向

減去了函式指標

物件導向並沒有新增東西

而是給我們更安全的規範

### 函數式

減去了變數

沒有變量就沒有競爭條件、平行計算等非常多的麻煩

得到一個乾淨純粹的程式

我們的版本控制系統就是這樣

記下每一筆交易而不是狀態

計算所有交易就可以得到最終狀態．

---

幾十年來，

軟體一直在做減法而不是加法．

## SOLID

- 單一職責

這是常被誤解的名字，

這是指他只替一個使用者做一件事，

對不同的使用者來說同一件事可能不同（技術與商業是有差的）

- 開放封閉

新增不修改

- 李氏代換

這個原則提醒我要注意實作的副作用

測試時要注意

- 介面隔離

不需要的不要帶

- 依賴反轉

## 架構

- 拆分邏輯、設定邊界
- 依賴的方向很重要
- 以領域、使用案例為核心，而不是IO，我們不在乎程式是給 rpc 還是 web

>controller -> service -> repository
>
>- 被資料端綁架，完全被按「表」操課

- 以元件或領域當 package，而不是 controller, service...等

> 水平拆分讓架構不明顯，
>
> 而且暴露不必要的細節．

### 解耦的謬誤

並不是使用了微服務架構就是解耦

而是要基於元件來解耦，基於依賴

### 框架是細節

別讓框架進入核心

框架只是補助、外人

## 測試

測試依賴於我們的產品程式碼

這代表他非常容易改動

- 不讓測試特定化
- 測試也需要解耦，否則會有痛苦的維護成本
